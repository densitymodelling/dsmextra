<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Interactive maps of extrapolation — map_extrapolation • dsmextra</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Interactive maps of extrapolation — map_extrapolation" />
<meta property="og:description" content="Produces interactive html maps of extrapolation values in the prediction area. The function relies on the leaflet package (Cheng et al. 2018), and thus requires an internet connection (i.e. will not work offline)." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dsmextra</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/dsmextra-vignette.html">A short introduction to dsmextra</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Interactive maps of extrapolation</h1>
    
    <div class="hidden name"><code>map_extrapolation.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Produces interactive html maps of extrapolation values in the prediction area. The function relies on the <code><a href='https://rdrr.io/pkg/leaflet/man/leaflet.html'>leaflet</a></code> package (Cheng et al. 2018), and thus requires an internet connection (i.e. will not work offline).</p>
    </div>

    <pre class="usage"><span class='fu'>map_extrapolation</span>(
  <span class='kw'>map.type</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>base.layer</span> <span class='kw'>=</span> <span class='st'>"ocean"</span>,
  <span class='kw'>extrapolation.values</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>gower.values</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>covariate.names</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>prediction.grid</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>coordinate.system</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>sightings</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>tracks</span> <span class='kw'>=</span> <span class='kw'>NULL</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>map.type</th>
      <td><p>Character string. Type of map to be returned. Either <code>extrapolation</code> for an extrapolation map, <code>mic</code> for a map of the most influential covariates, or <code>nearby</code> for a map of the percentage of data nearby.</p></td>
    </tr>
    <tr>
      <th>base.layer</th>
      <td><p>Base layer used for mapping. The default is <code>ocean</code>, which uses the ESRI.OceanBasemap. Use <code>world</code> for ESRI.WorldImagery and <code>gray</code> for ESRI.WorldGrayCanvas. Available map tiles can be viewed at <a href='https://leaflet-extras.github.io/leaflet-providers/preview/'>https://leaflet-extras.github.io/leaflet-providers/preview/</a>.</p></td>
    </tr>
    <tr>
      <th>extrapolation.values</th>
      <td><p>List object as returned by compute_extrapolation. Only valid when <code>map.type = extrapolation</code> or <code>map.type = mic</code>.</p></td>
    </tr>
    <tr>
      <th>gower.values</th>
      <td><p>Raster layer object as returned by compute_nearby. Only valid when <code>map.type = nearby</code>.</p></td>
    </tr>
    <tr>
      <th>covariate.names</th>
      <td><p>Character string. Names of the covariates of interest.</p></td>
    </tr>
    <tr>
      <th>prediction.grid</th>
      <td><p>Prediction data.frame. This contains both geographic coordinates (<code>x</code>, <code>y</code>) and covariate values associated with the target locations for which predictions are desired. Typically, these locations are taken as the centroids of the grid cells in a spatial prediction grid/raster. See <code><a href='https://rdrr.io/pkg/dsm/man/predict.dsm.html'>predict.dsm</a></code>.</p></td>
    </tr>
    <tr>
      <th>coordinate.system</th>
      <td><p>Projected coordinate system relevant to the study location. Can be either a character string or an object of class <code><a href='https://rdrr.io/pkg/sp/man/CRS-class.html'>CRS</a></code>.</p></td>
    </tr>
    <tr>
      <th>sightings</th>
      <td><p>Species observations (optional). Can be supplied as a <code>matrix</code> of coordinates, a <code>data.frame</code>, a <code><a href='https://rdrr.io/pkg/sp/man/SpatialPoints.html'>SpatialPoints</a></code> object or a <code><a href='https://rdrr.io/pkg/sp/man/SpatialPoints.html'>SpatialPointsDataFrame</a></code> object. Circle markers will be proportional to group size if the data contain a column labelled <code>size</code>.</p></td>
    </tr>
    <tr>
      <th>tracks</th>
      <td><p>Survey tracks (optional). Can be supplied as a <code>matrix</code> of coordinates, a <code>data.frame</code>, a <code><a href='https://rdrr.io/pkg/sp/man/SpatialLines.html'>SpatialLines</a></code> object or a <code><a href='https://rdrr.io/pkg/sp/man/SpatialLines.html'>SpatialLinesDataFrame</a></code> object. A <code>TransectID</code> field is required for matrix or data.frame inputs.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An interactive html map.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Bouchet PJ, Miller DL, Roberts JJ, Mannocci L, Harris CM and Thomas L (2019). From here and now to there and then: Practical recommendations for extrapolating cetacean density surface models to novel conditions. CREEM Technical Report 2019-01, 59 p. <a href='https://research-repository.st-andrews.ac.uk/handle/10023/18509'>https://research-repository.st-andrews.ac.uk/handle/10023/18509</a></p>
<p>Cheng J, Karambelkar B, Xie Y (2018). leaflet: Create Interactive Web Maps with the JavaScript 'Leaflet' Library. R package version 2.0.2. <a href='https://CRAN.R-project.org/package=leaflet'>https://CRAN.R-project.org/package=leaflet</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>dsmextra</span>)

<span class='co'># Load the Mid-Atlantic sperm whale data (see ?spermwhales)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>spermwhales</span>)

<span class='co'># Extract the data</span>
<span class='no'>segs</span> <span class='kw'>&lt;-</span> <span class='no'>spermwhales</span>$<span class='no'>segs</span>
<span class='no'>predgrid</span> <span class='kw'>&lt;-</span> <span class='no'>spermwhales</span>$<span class='no'>predgrid</span>

<span class='co'># Define relevant coordinate system</span>
<span class='no'>my_crs</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sp</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/sp/man/CRS-class.html'>CRS</a></span>(<span class='st'>"+proj=aea +lat_1=38 +lat_2=30 +lat_0=34 +lon_0=-73 +x_0=0
 +y_0=0 +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0"</span>)

 <span class='co'># Define covariates of interest</span>
 <span class='no'>my_cov</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"Depth"</span>, <span class='st'>"DistToCAS"</span>, <span class='st'>"SST"</span>, <span class='st'>"EKE"</span>, <span class='st'>"NPP"</span>)

<span class='co'># Assess extrapolation in the multivariate space defined by five covariates</span>
<span class='no'>spermw.extrapolation</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/dsmextra/man/compute_extrapolation.html'>compute_extrapolation</a></span>(<span class='kw'>segments</span> <span class='kw'>=</span> <span class='no'>segs</span>,
      <span class='kw'>covariate.names</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"Depth"</span>, <span class='st'>"DistToCAS"</span>, <span class='st'>"SST"</span>, <span class='st'>"EKE"</span>, <span class='st'>"NPP"</span>),
      <span class='kw'>prediction.grid</span> <span class='kw'>=</span> <span class='no'>predgrid</span>,
      <span class='kw'>coordinate.system</span> <span class='kw'>=</span> <span class='no'>my_crs</span>)</div><div class='output co'>#&gt; <span class='message'>Computing ...</span></div><div class='output co'>#&gt; <span class='message'>Done!</span></div><div class='input'>
<span class='co'># Assess the percentage of data nearby</span>
<span class='no'>spermw.nearby</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/dsmextra/man/compute_nearby.html'>compute_nearby</a></span>(<span class='kw'>segments</span> <span class='kw'>=</span> <span class='no'>segs</span>,
                               <span class='kw'>prediction.grid</span> <span class='kw'>=</span> <span class='no'>predgrid</span>,
                               <span class='kw'>coordinate.system</span> <span class='kw'>=</span> <span class='no'>my_crs</span>,
                               <span class='kw'>covariate.names</span> <span class='kw'>=</span> <span class='no'>my_cov</span>,
                               <span class='kw'>nearby</span> <span class='kw'>=</span> <span class='fl'>1</span>)</div><div class='output co'>#&gt; <span class='message'>Preprocessing data ...</span></div><div class='output co'>#&gt; <span class='message'>Calculating distances ....</span></div><div class='output co'>#&gt; <span class='message'>Calculating the geometric variance...</span></div><div class='output co'>#&gt; <span class='message'>Calculating cumulative frequencies ...</span></div><div class='output co'>#&gt; <span class='message'>Finishing up ...</span></div><div class='output co'>#&gt; <span class='message'>Done!</span></div><div class='input'>
<span class='co'># Generate maps</span>
<span class='fu'><a href='https://rdrr.io/pkg/dsmextra/man/map_extrapolation.html'>map_extrapolation</a></span>(<span class='kw'>map.type</span> <span class='kw'>=</span> <span class='st'>"extrapolation"</span>,
                  <span class='kw'>extrapolation.values</span> <span class='kw'>=</span> <span class='no'>spermw.extrapolation</span>,
                <span class='kw'>covariate.names</span> <span class='kw'>=</span> <span class='no'>my_cov</span>,
                <span class='kw'>prediction.grid</span> <span class='kw'>=</span> <span class='no'>predgrid</span>,
                <span class='kw'>coordinate.system</span> <span class='kw'>=</span> <span class='no'>my_crs</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: map_extrapolation relies on the leaflet package, which is built around a Web Mercator projection (EPSG:3857), and therefore requires rasters to be reprojected for plotting. As a result, minor discrepancies may  occur between the interactive maps shown in the viewer, and the underlying raw data. The latter can be accessed directly from the extrapolation.values or gower.values objects and visualised using alternative packages such as ggplot2.</span></div><div class='input'>
<span class='fu'><a href='https://rdrr.io/pkg/dsmextra/man/map_extrapolation.html'>map_extrapolation</a></span>(<span class='kw'>map.type</span> <span class='kw'>=</span> <span class='st'>"mic"</span>,
                <span class='kw'>extrapolation.values</span> <span class='kw'>=</span> <span class='no'>spermw.extrapolation</span>,
                <span class='kw'>covariate.names</span> <span class='kw'>=</span> <span class='no'>my_cov</span>,
                <span class='kw'>prediction.grid</span> <span class='kw'>=</span> <span class='no'>predgrid</span>,
                <span class='kw'>coordinate.system</span> <span class='kw'>=</span> <span class='no'>my_crs</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: map_extrapolation relies on the leaflet package, which is built around a Web Mercator projection (EPSG:3857), and therefore requires rasters to be reprojected for plotting. As a result, minor discrepancies may  occur between the interactive maps shown in the viewer, and the underlying raw data. The latter can be accessed directly from the extrapolation.values or gower.values objects and visualised using alternative packages such as ggplot2.</span></div><div class='input'>
<span class='fu'><a href='https://rdrr.io/pkg/dsmextra/man/map_extrapolation.html'>map_extrapolation</a></span>(<span class='kw'>map.type</span> <span class='kw'>=</span> <span class='st'>"nearby"</span>,
                <span class='kw'>gower.values</span> <span class='kw'>=</span> <span class='no'>spermw.nearby</span>,
                <span class='kw'>covariate.names</span> <span class='kw'>=</span> <span class='no'>my_cov</span>,
                <span class='kw'>prediction.grid</span> <span class='kw'>=</span> <span class='no'>predgrid</span>,
                <span class='kw'>coordinate.system</span> <span class='kw'>=</span> <span class='no'>my_crs</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: map_extrapolation relies on the leaflet package, which is built around a Web Mercator projection (EPSG:3857), and therefore requires rasters to be reprojected for plotting. As a result, minor discrepancies may  occur between the interactive maps shown in the viewer, and the underlying raw data. The latter can be accessed directly from the extrapolation.values or gower.values objects and visualised using alternative packages such as ggplot2.</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Phil J. Bouchet</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Phil Bouchet, David Miller, Laura Mannocci.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


